import React, { useEffect, useState } from "react";
import { Main } from "./styles";
import { Buffer } from "buffer";

const HistoryItem = ({ data, images, setCurrentAudio }) => {
  const [coverImage, setCoverImage] = useState("");
  useEffect(() => {
    if (data && !data.image?.length) return;
    const image = new Buffer.from(data.image).toString("base64");
    setCoverImage("data:image/png;base64," + image);
  }, [data]);

  return (
    <Main>
      <div className="wrapper" onClick={() => setCurrentAudio(data)}>
        <div className="left">
          <div className="image">
            <img
              src={coverImage ? coverImage : images.pngs.defaultCover}
              alt="cover"
            />
          </div>
          <div className="name">
            <h2 className="songName">{data.songName}</h2>
            <h3 className="singer">{data.singerName}</h3>
          </div>
        </div>
        <div className="right">
          <div className="playCount">
            <i>
              <svg
                width="10"
                height="12"
                viewBox="0 0 10 12"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M9.65909 7.07169C9.61648 7.13001 9.41761 7.37789 9.26136 7.53828L9.17614 7.62576C7.98295 8.95261 5.0142 10.9502 3.50852 11.5917C3.50852 11.6063 2.61364 11.9854 2.1875 12H2.13068C1.47727 12 0.866477 11.6209 0.553977 11.0085C0.383523 10.6731 0.227273 9.69623 0.213068 9.68165C0.0852273 8.8068 0 7.46683 0 5.99271C0 4.44714 0.0852273 3.04739 0.241477 2.18712C0.241477 2.17254 0.397727 1.38518 0.497159 1.12272C0.653409 0.743621 0.9375 0.422843 1.29261 0.218712C1.5767 0.072904 1.875 0 2.1875 0C2.5142 0.0145808 3.125 0.234751 3.36648 0.335358C4.95739 0.976914 7.99716 3.07655 9.16193 4.35966C9.3608 4.56379 9.57386 4.81167 9.63068 4.86999C9.87216 5.19077 10 5.58445 10 6.00875C10 6.38639 9.88636 6.76549 9.65909 7.07169Z"
                  fill="#7C8DB5"
                />
              </svg>
            </i>
            <p>120k</p>
          </div>
          <div className="comments">
            <svg
              width="16"
              height="16"
              viewBox="0 0 16 16"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M8.00356 0C3.5861 -1.74557e-06 0.00394223 3.5798 1.55988e-05 7.99827C-0.00253403 9.28664 0.307507 10.5564 0.903527 11.6985C0.960442 11.8053 1.01024 11.912 1.06716 12.0116C1.19477 12.2576 1.22033 12.5439 1.1383 12.8086C0.910048 13.4176 0.719966 14.0403 0.569157 14.673C0.569157 14.9861 0.661642 15.1711 0.996013 15.1711C1.60366 15.0347 2.20238 14.8613 2.78881 14.6516C3.04361 14.5851 3.31307 14.6026 3.55715 14.7014C3.77769 14.8153 3.97689 14.979 4.19743 15.0786H4.26858C6.7489 16.3844 9.73145 16.2973 12.1313 14.8489C14.5312 13.4005 15.9987 10.8018 16 7.99827C15.9961 3.58257 12.4182 0.00392332 8.00356 0Z"
                fill="#7C8DB5"
              />
              <path
                d="M4.20871 9.22783C3.65546 9.22783 3.20697 8.77933 3.20697 8.22609C3.20697 7.67284 3.65546 7.22435 4.20871 7.22435C4.76195 7.22435 5.21045 7.67284 5.21045 8.22609C5.21045 8.77933 4.76195 9.22783 4.20871 9.22783Z"
                fill="#fff"
                className="excluded"
              />
              <path
                d="M7.82607 9.22783C7.55983 9.2297 7.30394 9.12476 7.11568 8.93649C6.92741 8.74822 6.82247 8.49233 6.82433 8.22609C6.82433 7.82092 7.0684 7.45565 7.44273 7.3006C7.81705 7.14555 8.24792 7.23126 8.53441 7.51775C8.82091 7.80425 8.90661 8.23511 8.75156 8.60944C8.59651 8.98376 8.23124 9.22783 7.82607 9.22783Z"
                fill="#fff"
                className="excluded"
              />
              <path
                d="M11.4365 9.22783C10.8833 9.22783 10.4348 8.77933 10.4348 8.22609C10.4348 7.67284 10.8833 7.22435 11.4365 7.22435C11.9898 7.22435 12.4383 7.67284 12.4383 8.22609C12.4383 8.77933 11.9898 9.22783 11.4365 9.22783Z"
                fill="#fff"
                className="excluded"
              />
            </svg>
          </div>
          <div className="like">
            <svg
              width="18"
              height="17"
              viewBox="0 0 18 17"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                opacity="0.4"
                d="M8.81329 16.1979C6.91076 15.0227 5.14218 13.6371 3.53989 12.0663C2.40874 10.9448 1.54487 9.57539 1.01429 8.06272C0.066265 5.11269 1.16983 1.74123 4.25091 0.74033C5.87717 0.229609 7.64586 0.543129 9.00586 1.5832V1.5832C10.3664 0.544292 12.1345 0.230874 13.7608 0.74033C16.8419 1.74123 17.9529 5.11269 17.0048 8.06272C16.4786 9.57396 15.6198 10.9433 14.494 12.0663C12.8903 13.6354 11.1219 15.0209 9.22065 16.1979L9.01327 16.3333L8.81329 16.1979Z"
                fill="#B9C0DE"
              />
              <path
                d="M9.00905 16.3333L8.81328 16.1979C6.9084 15.0228 5.13735 13.6372 3.53247 12.0663C2.39596 10.9464 1.52695 9.57682 0.992059 8.06272C0.0514384 5.11269 1.155 1.74123 4.23609 0.740329C5.86235 0.229607 7.65436 0.543367 9.00905 1.59214V16.3333Z"
                fill="#7C8DB5"
              />
              <path
                d="M14.192 6.33269V6.33269C14.0246 6.32191 13.8687 6.23825 13.7608 6.1013C13.6529 5.96436 13.6026 5.78617 13.6215 5.60847V5.60847C13.6396 5.02317 13.3066 4.49042 12.793 4.28314C12.4674 4.19424 12.2701 3.84156 12.3516 3.49374C12.4289 3.15152 12.7494 2.93873 13.0715 3.01575C13.1121 3.0225 13.1513 3.03723 13.1869 3.05921C14.2167 3.45548 14.8834 4.52201 14.8303 5.68813C14.8286 5.86488 14.7597 6.03332 14.6394 6.15484C14.519 6.27637 14.3575 6.34055 14.192 6.33269Z"
                fill="white"
              />
            </svg>
          </div>
        </div>
      </div>
    </Main>
  );
};

export default HistoryItem;
